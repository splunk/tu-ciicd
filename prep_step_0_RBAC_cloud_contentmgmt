Splunk Roles & Users
https://docs.splunk.com/Documentation/SplunkCloud/latest/Security/Rolesandcapabilities
https://docs.splunk.com/Documentation/SplunkCloud/latest/Security/Rolesandcapabilities#Splunk_platform_capabilities
https://docs.splunk.com/Documentation/Splunk/9.3.1/Security/Aboutusersandroles#How_role_inheritance_works

- Splunk roles and the capabilities they provide are additive.
- Roles do not take access away
- A user can belong to one or more roles. By default the user role in Splunk, allows very permissive permission. 
- Roles may be assigned to most of the knowledge objects, but not always.
- However, App and Addons, even from SplunkBase may have not been created with RBAC in mind, and therefore be too permissive by default
- If a knowledge object does not have an owner, Splunk cloud will override with user=nobody
- As such if all knowledge objects do not have an explicit owner set, the role assigned will be associated with nobody, and as a system user/role, the capabilities granted cannot be overridden.
- In nearly all cases, capabilities whose names begin with edit_ give users the ability to perform create, read, update, and delete operations for the feature with which they associate.
- Do NOT modify or use Splunk system roles or user in Cloud, therefore, do not apply the the default system roles

Splunk ACS required permissions
https://docs.splunk.com/Documentation/SplunkCloud/9.2.2406/Config/RBAC#Manage_ACS_endpoint_access_with_capabilities
- any user/role that has the required ACS permissions can use ACS, does not have to be explicitly sc_admin

# PREQREQURISTES to App install Requirement
- Ensure permissions are set on other apps with least privledge
  - SplunkBase apps and addons are typically overprovisioned
  - Ensure the Splunk sustem users are not used by KOs that will be managed by your users 
  -  User,Power,Admin,Nobody, Splunk-System-User

- Real time searches are enabled by default in Victoria Cloud

-----------------
# Overview 
# Create an sc_admin user on ALL search head groups AdHoc and ES and (ITSI) if needed.
- Keep the users with sc_admin as low as possible to ensure platform stability

# Create Content Management Roles for each Search Head group, eg. IT-content-mgr and ES-content-mgr 
- ON ALL Search Head Groups, all these roles will be defined
- This configuration will help ensure that each of these content roles will have permissions removed in the Search Head Groups that they should not write to.

# Create Content Users for each Search Head group, eg. IT-content-owner and ES-content-owner
- ON ALL Search Head Groups, all these content owners will be defined.
- This configuration will help ensure that that there is always an availalable owner to assign, so that the Splunk system user like NOBODY, does not inadvertantly get access to KOs'



# Create content role on Adhoc first. 
- Log in to GUI of Adhoc as an sc_admin
- Add export_apps role to your sc_admin user

# Create a role called [es_security_content_manager]
On AD-HOC,and ITSI this role has NO CAPABILITIES
NO search
NO scheduled search
NO access to all indexes
NO capabilities
# Set the es_security_content_manager role on Ad-Hoc and ITSI to limitied Jobs, search windows, and diskspace
Role search job limit, 5 standard, 5 real-time
User search job limit, 3 standard, 1 real-time
Role search time window max 60, earliest 600
Disk space limit 10mb
Set the default app to - SEARCH app

- Reload Auth Configuration

Return to role es_security_content_manager observe 5 NATIVE capabilities have returned automatically back, remove them again, except edit_own_objects, and list_all_objects

- Create a user called es_security_content_owner
set the default app to Search and Reporting
ensure there are NO other roles, including user inherited.
assign only to the role es_security_content_manager


# now repeat for bu_adhoc_content_manager on Adhoc still 






###################
As an sc_admin on the GUI on ES SH 
- Add export_apps role to your sc_admin user

- Create a role called es_security_content_manager
inherited the roles ess_admin, and ess_analyst, export_apps, ess_user
add _audit index, _config_tracker index, as included, not default

- change the roles default app to SplunkEnterpriseSecuritySuite

- Create a user called es_security_content_owner
ensure there are NO other roles, including user inherited.
assign only to the role es_security_content_manager
set default app to SplunkEnterpriseSecurity

########
- Create a user called es_gui_demo_developer_user
this is for demonstration purposes, represents your usersâ€™ own accounts
assign only to the role es_security_content_manager
set default app to SplunkEnterpriseSecurity

##########
- log out of both adhoc an es 
- validate that the user can
------- login 
-------- can't log in to other
--- 
